{"ast":null,"code":"import { ref, computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { useToast } from 'vue-toastification';\nexport default {\n  name: 'ProductDetailView',\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const toast = useToast();\n\n    // State\n    const quantity = ref(1);\n    const productId = computed(() => parseInt(route.params.id));\n\n    // Computed properties\n    const product = computed(() => store.getters['products/currentProduct']);\n    const allProducts = computed(() => store.getters['products/allProducts']);\n    const loading = computed(() => store.getters.isLoading);\n    const relatedProducts = computed(() => {\n      if (!product.value) return [];\n\n      // Filter products in the same category, excluding current product\n      return allProducts.value.filter(p => p.category === product.value.category && p.id !== product.value.id).slice(0, 4); // Limit to 4 products\n    });\n\n    // Methods\n    const fetchProduct = async () => {\n      await store.dispatch('products/fetchProduct', productId.value);\n\n      // If we don't have enough related products (same category), fetch all products\n      if (!allProducts.value.length) {\n        await store.dispatch('products/fetchProducts');\n      }\n    };\n    const addToCart = () => {\n      if (product.value) {\n        store.dispatch('cart/addToCart', {\n          product: product.value,\n          quantity: quantity.value\n        });\n        quantity.value = 1; // Reset quantity after adding\n      }\n    };\n    const formatPrice = price => {\n      return new Intl.NumberFormat('ru-RU').format(price);\n    };\n\n    // Lifecycle hooks\n    onMounted(() => {\n      fetchProduct();\n    });\n    return {\n      product,\n      relatedProducts,\n      loading,\n      quantity,\n      addToCart,\n      formatPrice\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useStore","useRoute","useToast","name","setup","store","route","toast","quantity","productId","parseInt","params","id","product","getters","allProducts","loading","isLoading","relatedProducts","value","filter","p","category","slice","fetchProduct","dispatch","length","addToCart","formatPrice","price","Intl","NumberFormat","format"],"sources":["/app/src/views/ProductDetailView.vue"],"sourcesContent":["<template>\n  <div class=\"velo-container py-12 md:py-16\">\n    <div v-if=\"loading\" class=\"flex justify-center items-center py-32\">\n      <div class=\"animate-spin h-12 w-12 border-t-2 border-b-2 border-[color:var(--color-accent)]\"></div>\n    </div>\n    \n    <div v-else-if=\"!product\" class=\"text-center py-32\">\n      <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-16 w-16 mx-auto text-[color:var(--color-light-text)] mb-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1\" d=\"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n      <h2 class=\"text-3xl font-light text-[color:var(--color-dark)] mb-4\">Товар не найден</h2>\n      <p class=\"text-[color:var(--color-light-text)] mb-8\">Запрашиваемый товар не существует или был удален.</p>\n      <router-link to=\"/shop\" class=\"velo-btn velo-btn-primary inline-block\">\n        Вернуться в каталог\n      </router-link>\n    </div>\n    \n    <div v-else>\n      <!-- Breadcrumbs -->\n      <div class=\"flex items-center text-sm text-[color:var(--color-light-text)] mb-12\">\n        <router-link to=\"/\" class=\"hover:text-[color:var(--color-accent)] transition duration-150\">Главная</router-link>\n        <span class=\"mx-2\">/</span>\n        <router-link to=\"/shop\" class=\"hover:text-[color:var(--color-accent)] transition duration-150\">Каталог</router-link>\n        <span class=\"mx-2\">/</span>\n        <span class=\"text-[color:var(--color-accent)]\">{{ product.title }}</span>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-12 gap-12 md:gap-16\">\n        <!-- Product Image -->\n        <div class=\"md:col-span-6 lg:col-span-7\">\n          <div class=\"overflow-hidden bg-[color:var(--color-primary)] border border-[color:var(--color-secondary)]\">\n            <img \n              :src=\"product.image_url || 'https://via.placeholder.com/800x800?text=Velo'\" \n              :alt=\"product.title\" \n              class=\"w-full h-auto object-cover\"\n            >\n          </div>\n        </div>\n        \n        <!-- Product Info -->\n        <div class=\"md:col-span-6 lg:col-span-5\">\n          <h1 class=\"text-3xl font-light text-[color:var(--color-dark)] mb-4\">{{ product.title }}</h1>\n          \n          <div class=\"text-2xl font-medium text-[color:var(--color-accent)] mb-8\">\n            {{ formatPrice(product.price) }} ₽\n          </div>\n          \n          <div class=\"mb-8 border-t border-[color:var(--color-secondary)] pt-8\">\n            <p class=\"text-[color:var(--color-light-text)] leading-relaxed\">{{ product.description }}</p>\n          </div>\n          \n          <div class=\"mb-8\">\n            <span class=\"text-sm font-medium text-[color:var(--color-dark)]\">Категория:</span>\n            <span class=\"text-[color:var(--color-light-text)] uppercase tracking-wider text-xs ml-2 border-b border-[color:var(--color-secondary)] pb-0.5\">\n              {{ product.category }}\n            </span>\n          </div>\n          \n          <div class=\"mb-10\">\n            <label for=\"quantity\" class=\"velo-label mb-2\">Количество</label>\n            <div class=\"flex\">\n              <button \n                class=\"border border-[color:var(--color-secondary)] text-[color:var(--color-dark)] px-4 py-2 hover:bg-[color:var(--color-primary)] transition duration-150\" \n                @click=\"quantity > 1 && quantity--\"\n              >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M20 12H4\" />\n                </svg>\n              </button>\n              <input \n                id=\"quantity\" \n                type=\"number\" \n                v-model.number=\"quantity\" \n                min=\"1\" \n                class=\"block w-16 py-2 px-3 border-y border-[color:var(--color-secondary)] focus:ring-[color:var(--color-accent)] focus:border-[color:var(--color-accent)] text-center text-[color:var(--color-dark)]\"\n              >\n              <button \n                class=\"border border-[color:var(--color-secondary)] text-[color:var(--color-dark)] px-4 py-2 hover:bg-[color:var(--color-primary)] transition duration-150\" \n                @click=\"quantity++\"\n              >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M12 4v16m8-8H4\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n          \n          <div class=\"flex flex-col sm:flex-row gap-4\">\n            <button \n              class=\"velo-btn velo-btn-primary w-full flex items-center justify-center\"\n              @click=\"addToCart\"\n            >\n              <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\" />\n              </svg>\n              Добавить в корзину\n            </button>\n            <router-link to=\"/shop\" class=\"py-3 px-6 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl transition duration-150 w-full sm:flex-1 text-center text-sm font-medium flex items-center justify-center\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\n              </svg>\n              Продолжить покупки\n            </router-link>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Related Products -->\n      <div class=\"mt-24\">\n        <h2 class=\"text-2xl font-light text-[color:var(--color-dark)] mb-12 text-center\">Похожие товары</h2>\n        <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-x-8 gap-y-12\">\n          <div \n            v-for=\"relatedProduct in relatedProducts\" \n            :key=\"relatedProduct.id\" \n            class=\"group\"\n          >\n            <div class=\"relative mb-4 overflow-hidden bg-[color:var(--color-primary)] border border-[color:var(--color-secondary)]\" style=\"aspect-ratio: 1/1;\">\n              <img \n                :src=\"relatedProduct.image_url || 'https://via.placeholder.com/300x300?text=Нет+изображения'\" \n                :alt=\"relatedProduct.title\" \n                class=\"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105\"\n              >\n              <div class=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-opacity duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100\">\n                <router-link \n                  :to=\"`/product/${relatedProduct.id}`\" \n                  class=\"bg-white text-[color:var(--color-accent)] p-3 shadow-md hover:bg-[color:var(--color-accent)] hover:text-white transition duration-150\"\n                  aria-label=\"Подробнее\"\n                >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                  </svg>\n                </router-link>\n              </div>\n            </div>\n            \n            <router-link :to=\"`/product/${relatedProduct.id}`\" class=\"block\">\n              <h3 class=\"font-medium text-[color:var(--color-dark)] mb-1 line-clamp-1\">{{ relatedProduct.title }}</h3>\n              <p class=\"text-[color:var(--color-light-text)] text-sm\">{{ formatPrice(relatedProduct.price) }} ₽</p>\n            </router-link>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { useToast } from 'vue-toastification';\n\nexport default {\n  name: 'ProductDetailView',\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const toast = useToast();\n    \n    // State\n    const quantity = ref(1);\n    const productId = computed(() => parseInt(route.params.id));\n    \n    // Computed properties\n    const product = computed(() => store.getters['products/currentProduct']);\n    const allProducts = computed(() => store.getters['products/allProducts']);\n    const loading = computed(() => store.getters.isLoading);\n    \n    const relatedProducts = computed(() => {\n      if (!product.value) return [];\n      \n      // Filter products in the same category, excluding current product\n      return allProducts.value\n        .filter(p => p.category === product.value.category && p.id !== product.value.id)\n        .slice(0, 4); // Limit to 4 products\n    });\n    \n    // Methods\n    const fetchProduct = async () => {\n      await store.dispatch('products/fetchProduct', productId.value);\n      \n      // If we don't have enough related products (same category), fetch all products\n      if (!allProducts.value.length) {\n        await store.dispatch('products/fetchProducts');\n      }\n    };\n    \n    const addToCart = () => {\n      if (product.value) {\n        store.dispatch('cart/addToCart', { \n          product: product.value, \n          quantity: quantity.value \n        });\n        \n        quantity.value = 1; // Reset quantity after adding\n      }\n    };\n    \n    const formatPrice = (price) => {\n      return new Intl.NumberFormat('ru-RU').format(price);\n    };\n    \n    // Lifecycle hooks\n    onMounted(() => {\n      fetchProduct();\n    });\n    \n    return {\n      product,\n      relatedProducts,\n      loading,\n      quantity,\n      addToCart,\n      formatPrice\n    };\n  }\n};\n</script>\n\n<style scoped>\n/* Hide default number input spinners */\ninput[type=\"number\"]::-webkit-inner-spin-button,\ninput[type=\"number\"]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=\"number\"] {\n  -moz-appearance: textfield;\n}\n</style>\n"],"mappings":"AAoJA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAK;AAC9C,SAASC,QAAO,QAAS,MAAM;AAC/B,SAASC,QAAO,QAAS,YAAY;AACrC,SAASC,QAAO,QAAS,oBAAoB;AAE7C,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIL,QAAQ,CAAC,CAAC;IACxB,MAAMM,KAAI,GAAIL,QAAQ,CAAC,CAAC;IACxB,MAAMM,KAAI,GAAIL,QAAQ,CAAC,CAAC;;IAExB;IACA,MAAMM,QAAO,GAAIX,GAAG,CAAC,CAAC,CAAC;IACvB,MAAMY,SAAQ,GAAIX,QAAQ,CAAC,MAAMY,QAAQ,CAACJ,KAAK,CAACK,MAAM,CAACC,EAAE,CAAC,CAAC;;IAE3D;IACA,MAAMC,OAAM,GAAIf,QAAQ,CAAC,MAAMO,KAAK,CAACS,OAAO,CAAC,yBAAyB,CAAC,CAAC;IACxE,MAAMC,WAAU,GAAIjB,QAAQ,CAAC,MAAMO,KAAK,CAACS,OAAO,CAAC,sBAAsB,CAAC,CAAC;IACzE,MAAME,OAAM,GAAIlB,QAAQ,CAAC,MAAMO,KAAK,CAACS,OAAO,CAACG,SAAS,CAAC;IAEvD,MAAMC,eAAc,GAAIpB,QAAQ,CAAC,MAAM;MACrC,IAAI,CAACe,OAAO,CAACM,KAAK,EAAE,OAAO,EAAE;;MAE7B;MACA,OAAOJ,WAAW,CAACI,KAAI,CACpBC,MAAM,CAACC,CAAA,IAAKA,CAAC,CAACC,QAAO,KAAMT,OAAO,CAACM,KAAK,CAACG,QAAO,IAAKD,CAAC,CAACT,EAAC,KAAMC,OAAO,CAACM,KAAK,CAACP,EAAE,EAC9EW,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IAClB,CAAC,CAAC;;IAEF;IACA,MAAMC,YAAW,GAAI,MAAAA,CAAA,KAAY;MAC/B,MAAMnB,KAAK,CAACoB,QAAQ,CAAC,uBAAuB,EAAEhB,SAAS,CAACU,KAAK,CAAC;;MAE9D;MACA,IAAI,CAACJ,WAAW,CAACI,KAAK,CAACO,MAAM,EAAE;QAC7B,MAAMrB,KAAK,CAACoB,QAAQ,CAAC,wBAAwB,CAAC;MAChD;IACF,CAAC;IAED,MAAME,SAAQ,GAAIA,CAAA,KAAM;MACtB,IAAId,OAAO,CAACM,KAAK,EAAE;QACjBd,KAAK,CAACoB,QAAQ,CAAC,gBAAgB,EAAE;UAC/BZ,OAAO,EAAEA,OAAO,CAACM,KAAK;UACtBX,QAAQ,EAAEA,QAAQ,CAACW;QACrB,CAAC,CAAC;QAEFX,QAAQ,CAACW,KAAI,GAAI,CAAC,EAAE;MACtB;IACF,CAAC;IAED,MAAMS,WAAU,GAAKC,KAAK,IAAK;MAC7B,OAAO,IAAIC,IAAI,CAACC,YAAY,CAAC,OAAO,CAAC,CAACC,MAAM,CAACH,KAAK,CAAC;IACrD,CAAC;;IAED;IACA9B,SAAS,CAAC,MAAM;MACdyB,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC;IAEF,OAAO;MACLX,OAAO;MACPK,eAAe;MACfF,OAAO;MACPR,QAAQ;MACRmB,SAAS;MACTC;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}