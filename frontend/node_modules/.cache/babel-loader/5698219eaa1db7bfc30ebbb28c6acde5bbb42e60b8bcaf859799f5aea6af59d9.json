{"ast":null,"code":"import { ref, computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { useToast } from 'vue-toastification';\nexport default {\n  name: 'ProductDetailView',\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const toast = useToast();\n\n    // State\n    const quantity = ref(1);\n    const productId = computed(() => parseInt(route.params.id));\n\n    // Computed properties\n    const product = computed(() => store.getters['products/currentProduct']);\n    const allProducts = computed(() => store.getters['products/allProducts']);\n    const loading = computed(() => store.getters.isLoading);\n    const relatedProducts = computed(() => {\n      if (!product.value) return [];\n\n      // Filter products in the same category, excluding current product\n      return allProducts.value.filter(p => p.category === product.value.category && p.id !== product.value.id).slice(0, 4); // Limit to 4 products\n    });\n\n    // Methods\n    const fetchProduct = async () => {\n      await store.dispatch('products/fetchProduct', productId.value);\n\n      // If we don't have enough related products (same category), fetch all products\n      if (!allProducts.value.length) {\n        await store.dispatch('products/fetchProducts');\n      }\n    };\n    const addToCart = () => {\n      if (product.value) {\n        store.dispatch('cart/addToCart', {\n          product: product.value,\n          quantity: quantity.value\n        });\n        quantity.value = 1; // Reset quantity after adding\n      }\n    };\n    const formatPrice = price => {\n      return new Intl.NumberFormat('ru-RU').format(price);\n    };\n\n    // Lifecycle hooks\n    onMounted(() => {\n      fetchProduct();\n    });\n    return {\n      product,\n      relatedProducts,\n      loading,\n      quantity,\n      addToCart,\n      formatPrice\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useStore","useRoute","useToast","name","setup","store","route","toast","quantity","productId","parseInt","params","id","product","getters","allProducts","loading","isLoading","relatedProducts","value","filter","p","category","slice","fetchProduct","dispatch","length","addToCart","formatPrice","price","Intl","NumberFormat","format"],"sources":["C:\\Users\\geeksaider\\VeloW\\frontend\\src\\views\\ProductDetailView.vue"],"sourcesContent":["<template>\n  <div class=\"velo-container py-12 md:py-16\">\n    <div v-if=\"loading\" class=\"flex justify-center py-20\">\n      <div class=\"animate-spin h-10 w-10 border-2 border-[color:var(--color-accent)] border-t-transparent rounded-full\"></div>\n    </div>\n    \n    <div v-else-if=\"!product\" class=\"text-center py-20\">\n      <h2 class=\"text-3xl font-light text-[color:var(--color-dark)] mb-6\">Товар не найден</h2>\n      <p class=\"text-[color:var(--color-light-text)] mb-10\">Запрашиваемый товар не существует или был удален.</p>\n      <router-link to=\"/shop\" class=\"velo-btn velo-btn-primary\">\n        Вернуться в каталог\n      </router-link>\n    </div>\n    \n    <div v-else>\n      <!-- Breadcrumbs -->\n      <div class=\"flex items-center text-sm text-[color:var(--color-light-text)] mb-10\">\n        <router-link to=\"/\" class=\"hover:text-[color:var(--color-accent)]\">Главная</router-link>\n        <span class=\"mx-2\">/</span>\n        <router-link to=\"/shop\" class=\"hover:text-[color:var(--color-accent)]\">Каталог</router-link>\n        <span class=\"mx-2\">/</span>\n        <span class=\"text-[color:var(--color-accent)]\">{{ product.title }}</span>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-12 gap-12 md:gap-16\">\n        <!-- Product Image -->\n        <div class=\"md:col-span-6 lg:col-span-7\">\n          <div class=\"overflow-hidden\">\n            <img \n              :src=\"product.image_url || 'https://via.placeholder.com/800x800?text=Velo'\" \n              :alt=\"product.title\" \n              class=\"w-full h-auto object-cover\"\n            >\n          </div>\n        </div>\n        \n        <!-- Product Info -->\n        <div class=\"md:col-span-6 lg:col-span-5\">\n          <h1 class=\"text-3xl font-light text-[color:var(--color-dark)] mb-4\">{{ product.title }}</h1>\n          \n          <div class=\"text-2xl text-[color:var(--color-accent)] mb-8\">\n            {{ formatPrice(product.price) }} ₽\n          </div>\n          \n          <div class=\"mb-8 border-t border-[color:var(--color-secondary)] pt-8\">\n            <p class=\"text-[color:var(--color-light-text)] leading-relaxed\">{{ product.description }}</p>\n          </div>\n          \n          <div class=\"mb-8\">\n            <span class=\"velo-label\">Категория:</span>\n            <span class=\"text-[color:var(--color-light-text)] uppercase tracking-wider text-xs ml-2 border-b border-[color:var(--color-secondary)]\">\n              {{ product.category }}\n            </span>\n          </div>\n          \n          <div class=\"mb-10\">\n            <label for=\"quantity\" class=\"velo-label\">Количество</label>\n            <div class=\"flex mt-2\">\n              <button \n                class=\"border border-[color:var(--color-secondary)] text-[color:var(--color-dark)] px-4 py-2\" \n                @click=\"quantity > 1 && quantity--\"\n              >\n                &minus;\n              </button>\n              <input \n                id=\"quantity\" \n                type=\"number\" \n                v-model.number=\"quantity\" \n                min=\"1\" \n                class=\"velo-input rounded-none w-16 text-center border-x-0\"\n              >\n              <button \n                class=\"border border-[color:var(--color-secondary)] text-[color:var(--color-dark)] px-4 py-2\" \n                @click=\"quantity++\"\n              >\n                &#43;\n              </button>\n            </div>\n          </div>\n          \n          <div class=\"flex flex-col sm:flex-row gap-4\">\n            <button \n              class=\"velo-btn velo-btn-primary w-full sm:flex-1\"\n              @click=\"addToCart\"\n            >\n              Добавить в корзину\n            </button>\n            <router-link to=\"/shop\" class=\"velo-btn velo-btn-secondary w-full sm:flex-1 text-center\">\n              Продолжить покупки\n            </router-link>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Related Products -->\n      <div class=\"mt-16\">\n        <h2 class=\"text-2xl font-bold text-slate-800 mb-6\">Похожие товары</h2>\n        <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <div \n            v-for=\"relatedProduct in relatedProducts\" \n            :key=\"relatedProduct.id\" \n            class=\"card product-card\"\n          >\n            <div class=\"h-48 mb-4 overflow-hidden rounded-md\">\n              <img \n                :src=\"relatedProduct.image_url || 'https://via.placeholder.com/300x300?text=Нет+изображения'\" \n                :alt=\"relatedProduct.title\" \n                class=\"w-full h-full object-cover\"\n              >\n            </div>\n            \n            <h3 class=\"font-semibold text-slate-800 mb-2\">{{ relatedProduct.title }}</h3>\n            <div class=\"flex items-center justify-between mt-auto\">\n              <span class=\"font-bold text-slate-800\">{{ formatPrice(relatedProduct.price) }} ₽</span>\n              <router-link \n                :to=\"`/product/${relatedProduct.id}`\" \n                class=\"text-sm text-slate-600 hover:text-slate-800\"\n              >\n                Подробнее\n              </router-link>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { useToast } from 'vue-toastification';\n\nexport default {\n  name: 'ProductDetailView',\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const toast = useToast();\n    \n    // State\n    const quantity = ref(1);\n    const productId = computed(() => parseInt(route.params.id));\n    \n    // Computed properties\n    const product = computed(() => store.getters['products/currentProduct']);\n    const allProducts = computed(() => store.getters['products/allProducts']);\n    const loading = computed(() => store.getters.isLoading);\n    \n    const relatedProducts = computed(() => {\n      if (!product.value) return [];\n      \n      // Filter products in the same category, excluding current product\n      return allProducts.value\n        .filter(p => p.category === product.value.category && p.id !== product.value.id)\n        .slice(0, 4); // Limit to 4 products\n    });\n    \n    // Methods\n    const fetchProduct = async () => {\n      await store.dispatch('products/fetchProduct', productId.value);\n      \n      // If we don't have enough related products (same category), fetch all products\n      if (!allProducts.value.length) {\n        await store.dispatch('products/fetchProducts');\n      }\n    };\n    \n    const addToCart = () => {\n      if (product.value) {\n        store.dispatch('cart/addToCart', { \n          product: product.value, \n          quantity: quantity.value \n        });\n        \n        quantity.value = 1; // Reset quantity after adding\n      }\n    };\n    \n    const formatPrice = (price) => {\n      return new Intl.NumberFormat('ru-RU').format(price);\n    };\n    \n    // Lifecycle hooks\n    onMounted(() => {\n      fetchProduct();\n    });\n    \n    return {\n      product,\n      relatedProducts,\n      loading,\n      quantity,\n      addToCart,\n      formatPrice\n    };\n  }\n};\n</script>\n\n<style scoped>\n.product-card {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\ninput[type=\"number\"]::-webkit-inner-spin-button,\ninput[type=\"number\"]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n</style>\n"],"mappings":"AAiIA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAK;AAC9C,SAASC,QAAO,QAAS,MAAM;AAC/B,SAASC,QAAO,QAAS,YAAY;AACrC,SAASC,QAAO,QAAS,oBAAoB;AAE7C,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIL,QAAQ,CAAC,CAAC;IACxB,MAAMM,KAAI,GAAIL,QAAQ,CAAC,CAAC;IACxB,MAAMM,KAAI,GAAIL,QAAQ,CAAC,CAAC;;IAExB;IACA,MAAMM,QAAO,GAAIX,GAAG,CAAC,CAAC,CAAC;IACvB,MAAMY,SAAQ,GAAIX,QAAQ,CAAC,MAAMY,QAAQ,CAACJ,KAAK,CAACK,MAAM,CAACC,EAAE,CAAC,CAAC;;IAE3D;IACA,MAAMC,OAAM,GAAIf,QAAQ,CAAC,MAAMO,KAAK,CAACS,OAAO,CAAC,yBAAyB,CAAC,CAAC;IACxE,MAAMC,WAAU,GAAIjB,QAAQ,CAAC,MAAMO,KAAK,CAACS,OAAO,CAAC,sBAAsB,CAAC,CAAC;IACzE,MAAME,OAAM,GAAIlB,QAAQ,CAAC,MAAMO,KAAK,CAACS,OAAO,CAACG,SAAS,CAAC;IAEvD,MAAMC,eAAc,GAAIpB,QAAQ,CAAC,MAAM;MACrC,IAAI,CAACe,OAAO,CAACM,KAAK,EAAE,OAAO,EAAE;;MAE7B;MACA,OAAOJ,WAAW,CAACI,KAAI,CACpBC,MAAM,CAACC,CAAA,IAAKA,CAAC,CAACC,QAAO,KAAMT,OAAO,CAACM,KAAK,CAACG,QAAO,IAAKD,CAAC,CAACT,EAAC,KAAMC,OAAO,CAACM,KAAK,CAACP,EAAE,EAC9EW,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IAClB,CAAC,CAAC;;IAEF;IACA,MAAMC,YAAW,GAAI,MAAAA,CAAA,KAAY;MAC/B,MAAMnB,KAAK,CAACoB,QAAQ,CAAC,uBAAuB,EAAEhB,SAAS,CAACU,KAAK,CAAC;;MAE9D;MACA,IAAI,CAACJ,WAAW,CAACI,KAAK,CAACO,MAAM,EAAE;QAC7B,MAAMrB,KAAK,CAACoB,QAAQ,CAAC,wBAAwB,CAAC;MAChD;IACF,CAAC;IAED,MAAME,SAAQ,GAAIA,CAAA,KAAM;MACtB,IAAId,OAAO,CAACM,KAAK,EAAE;QACjBd,KAAK,CAACoB,QAAQ,CAAC,gBAAgB,EAAE;UAC/BZ,OAAO,EAAEA,OAAO,CAACM,KAAK;UACtBX,QAAQ,EAAEA,QAAQ,CAACW;QACrB,CAAC,CAAC;QAEFX,QAAQ,CAACW,KAAI,GAAI,CAAC,EAAE;MACtB;IACF,CAAC;IAED,MAAMS,WAAU,GAAKC,KAAK,IAAK;MAC7B,OAAO,IAAIC,IAAI,CAACC,YAAY,CAAC,OAAO,CAAC,CAACC,MAAM,CAACH,KAAK,CAAC;IACrD,CAAC;;IAED;IACA9B,SAAS,CAAC,MAAM;MACdyB,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC;IAEF,OAAO;MACLX,OAAO;MACPK,eAAe;MACfF,OAAO;MACPR,QAAQ;MACRmB,SAAS;MACTC;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}